syntax = "proto3";

//import "llm.proto";
import "core.proto";

package instinct.retrieval;



enum MetadataFieldType {
  Unknown = 0;
  INT32 = 1;
  INT64 = 2;
  FLOAT = 3;
  DOUBLE = 4;
  BOOL = 5;
  VARCHAR = 6;
}

message MetadataFieldSchema {
  string name = 1;
  MetadataFieldType type = 2;
  string description = 3;
}

message MetadataSchema {
  repeated MetadataFieldSchema fields = 1;
  string description = 2;
}


message MetadataBoolQuery {
  repeated MetadataQuery must = 1;
  repeated MetadataQuery should = 2;
  repeated MetadataQuery mustNot = 3;
}

message MetadataTermQuery {
  instinct.core.PrimitiveVariable predicate = 1;
}

message MetadataQuery {
  oneof query {
      MetadataBoolQuery bool = 1;
      MetadataTermQuery term = 2;
  }
}

message SearchRequest {
  string query = 1;
  int32 top_k = 2;
  MetadataQuery metadata_filter = 3;
}

message SearchResponse {

}

message UpdateResult {
  int32 affected_rows = 1;
  repeated string returned_ids = 2;
  repeated instinct.core.Document failed_documents = 3;
}
